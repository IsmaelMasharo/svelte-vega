(globalThis.webpackChunksvelte_vega_demo=globalThis.webpackChunksvelte_vega_demo||[]).push([[179],{57685:(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module=__webpack_require__.nmd(module),(0,__webpack_require__(66809).configure)([__webpack_require__(68870)],module,!1)},16374:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,{parameters:()=>parameters});var client_api=__webpack_require__(14419),esm=__webpack_require__(87537),parameters={actions:{argTypesRegex:"^on[A-Z].*"}};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":case"argTypes":return esm.kg.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(value));case"decorators":return value.forEach((function(decorator){return(0,client_api.$9)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return(0,client_api.HZ)(loader,!1)}));case"parameters":return(0,client_api.h1)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return(0,client_api.My)(enhancer)}));case"globals":case"globalTypes":var v={};return v[key]=value,(0,client_api.h1)(v,!1);default:return console.log(key+" was not supported :( !")}}))},46113:(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__(66809)},50787:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Demo:()=>Demo,default:()=>SvelteVegaDemo_stories});var internal=__webpack_require__(85799),NOOP=function(){},EMPTY={};function shallowEqual(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:EMPTY,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:EMPTY,aKeys=Object.keys(a),bKeys=Object.keys(b);return a===b||aKeys.length===bKeys.length&&aKeys.every((function(key){return a[key]===b[key]}))}var vega_embed_module=__webpack_require__(72583);function updateMultipleDatasetsInView(view,data){Object.keys(data).forEach((function(name){!function updateSingleDatasetInView(view,name,value){value&&(function isFunction(functionToCheck){return!!functionToCheck&&"[object Function]"==={}.toString.call(functionToCheck)}(value)?value(view.data(name)):view.change(name,vega_embed_module.OU.changeset().remove((function(){return!0})).insert(value)))}(view,name,data[name])}))}var svelte=__webpack_require__(98515);function addSignalListenersToView(view,signalListeners){var signalNames=Object.keys(signalListeners);return signalNames.forEach((function(signalName){try{view.addSignalListener(signalName,signalListeners[signalName])}catch(error){console.warn("Cannot add invalid signal listener.",error)}})),signalNames.length>0}function combineSpecWithDimension(props){var spec=props.spec,width=props.width,height=props.height;return void 0!==width&&void 0!==height?Object.assign({},spec,{width,height}):void 0!==width?Object.assign({},spec,{width}):void 0!==height?Object.assign({},spec,{height}):spec}__webpack_require__(6886);var fast_deep_equal=__webpack_require__(69378),fast_deep_equal_default=__webpack_require__.n(fast_deep_equal);function getUniqueFieldNames(objects){var fields=new Set;return objects.forEach((function(o){Object.keys(o).forEach((function(field){fields.add(field)}))})),fields}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function removeSignalListenersFromView(view,signalListeners){var signalNames=Object.keys(signalListeners);return signalNames.forEach((function(signalName){try{view.removeSignalListener(signalName,signalListeners[signalName])}catch(error){console.warn("Cannot remove invalid signal listener.",error)}})),signalNames.length>0}function create_fragment(ctx){let div;return{c(){div=(0,internal.bG)("div")},m(target,anchor){(0,internal.$T)(target,div,anchor),ctx[8](div)},p:internal.ZT,i:internal.ZT,o:internal.ZT,d(detaching){detaching&&(0,internal.og)(div),ctx[8](null)}}}function instance($$self,$$props,$$invalidate){var __rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};let chartContainer,viewPromise,{props}=$$props,{onNewView=NOOP}=$$props,{signalListeners={}}=$$props,{onError=NOOP}=$$props,prevProps={spec:{}},prevSignalListeners={};function createView(){const{spec}=props,options=__rest(props,["spec"]),finalSpec=combineSpecWithDimension(props);viewPromise=(0,vega_embed_module.ZP)(chartContainer,finalSpec,options).then((({view})=>(addSignalListenersToView(view,signalListeners)&&view.run(),view))).catch(handleError),onNewView&&modifyView(onNewView)}function clearView(){modifyView((view=>{view.finalize()})),viewPromise=void 0}function modifyView(action){viewPromise&&viewPromise.then((view=>(view&&action(view),!0))).catch(handleError)}function handleError(error){onError(error),console.warn(error)}return(0,svelte.H3)((()=>{createView()})),(0,svelte.ev)((()=>{clearView()})),$$self.$$set=$$props=>{"props"in $$props&&$$invalidate(1,props=$$props.props),"onNewView"in $$props&&$$invalidate(2,onNewView=$$props.onNewView),"signalListeners"in $$props&&$$invalidate(3,signalListeners=$$props.signalListeners),"onError"in $$props&&$$invalidate(4,onError=$$props.onError)},$$self.$$.update=()=>{if(202&$$self.$$.dirty){const fieldSet=getUniqueFieldNames([props,prevProps]);if(fieldSet.delete("spec"),fieldSet.delete("width"),fieldSet.delete("height"),Array.from(fieldSet).some((f=>props[f]!==prevProps[f])))clearView(),createView();else{const specChanges=function computeSpecChanges(newSpec,oldSpec){if(newSpec===oldSpec)return!1;var changes={width:!1,height:!1,isExpensive:!1},fieldNames=getUniqueFieldNames([newSpec,oldSpec]);return!fieldNames.has("width")||"width"in newSpec&&"width"in oldSpec&&newSpec.width===oldSpec.width||("width"in newSpec&&"number"==typeof newSpec.width?changes.width=newSpec.width:changes.isExpensive=!0),!fieldNames.has("height")||"height"in newSpec&&"height"in oldSpec&&newSpec.height===oldSpec.height||("height"in newSpec&&"number"==typeof newSpec.height?changes.height=newSpec.height:changes.isExpensive=!0),fieldNames.delete("width"),fieldNames.delete("height"),_toConsumableArray(fieldNames).some((function(field){return!(field in newSpec)||!(field in oldSpec)||!fast_deep_equal_default()(newSpec[field],oldSpec[field])}))&&(changes.isExpensive=!0),!(!1===changes.width&&!1===changes.height&&!changes.isExpensive)&&changes}(combineSpecWithDimension(props),combineSpecWithDimension(prevProps)),newSignalListeners=signalListeners,oldSignalListeners=prevSignalListeners;if(specChanges)if(specChanges.isExpensive)clearView(),createView();else{const areSignalListenersChanged=!shallowEqual(newSignalListeners,oldSignalListeners);modifyView((view=>{!1!==specChanges.width&&view.width(specChanges.width),!1!==specChanges.height&&view.height(specChanges.height),areSignalListenersChanged&&(oldSignalListeners&&removeSignalListenersFromView(view,oldSignalListeners),newSignalListeners&&addSignalListenersToView(view,newSignalListeners)),view.run()}))}else shallowEqual(newSignalListeners,oldSignalListeners)||modifyView((view=>{oldSignalListeners&&removeSignalListenersFromView(view,oldSignalListeners),newSignalListeners&&addSignalListenersToView(view,newSignalListeners),view.run()}))}$$invalidate(6,prevProps=props),$$invalidate(7,prevSignalListeners=signalListeners)}},[chartContainer,props,onNewView,signalListeners,onError,modifyView,prevProps,prevSignalListeners,function div_binding($$value){internal.Vn[$$value?"unshift":"push"]((()=>{chartContainer=$$value,$$invalidate(0,chartContainer)}))}]}class VegaEmbed extends internal.f_{constructor(options){super(),(0,internal.S1)(this,options,instance,create_fragment,internal.N8,{props:1,onNewView:2,signalListeners:3,onError:4,modifyView:5})}get modifyView(){return this.$$.ctx[5]}}const VegaEmbed_svelte=VegaEmbed;function Vega_svelte_create_fragment(ctx){let vegaembed,current,vegaembed_props={props:ctx[0],onNewView:ctx[4],onError:ctx[2],signalListeners:ctx[1]};return vegaembed=new VegaEmbed_svelte({props:vegaembed_props}),ctx[8](vegaembed),{c(){(0,internal.YC)(vegaembed.$$.fragment)},m(target,anchor){(0,internal.ye)(vegaembed,target,anchor),current=!0},p(ctx,[dirty]){const vegaembed_changes={};1&dirty&&(vegaembed_changes.props=ctx[0]),4&dirty&&(vegaembed_changes.onError=ctx[2]),2&dirty&&(vegaembed_changes.signalListeners=ctx[1]),vegaembed.$set(vegaembed_changes)},i(local){current||((0,internal.Ui)(vegaembed.$$.fragment,local),current=!0)},o(local){(0,internal.et)(vegaembed.$$.fragment,local),current=!1},d(detaching){ctx[8](null),(0,internal.vp)(vegaembed,detaching)}}}function Vega_svelte_instance($$self,$$props,$$invalidate){let vegaEmbed,{props}=$$props,{data={}}=$$props,{onNewView=()=>{}}=$$props,{signalListeners={}}=$$props,{onError=NOOP}=$$props,prevData={};function update(){vegaEmbed&&Object.keys(data).length>0&&vegaEmbed.modifyView((view=>{updateMultipleDatasetsInView(view,data),view.resize().run()}))}return $$self.$$set=$$props=>{"props"in $$props&&$$invalidate(0,props=$$props.props),"data"in $$props&&$$invalidate(5,data=$$props.data),"onNewView"in $$props&&$$invalidate(6,onNewView=$$props.onNewView),"signalListeners"in $$props&&$$invalidate(1,signalListeners=$$props.signalListeners),"onError"in $$props&&$$invalidate(2,onError=$$props.onError)},$$self.$$.update=()=>{160&$$self.$$.dirty&&(shallowEqual(data,prevData)||update(),$$invalidate(7,prevData=data))},[props,signalListeners,onError,vegaEmbed,view=>{update(),onNewView(view)},data,onNewView,prevData,function vegaembed_binding($$value){internal.Vn[$$value?"unshift":"push"]((()=>{vegaEmbed=$$value,$$invalidate(3,vegaEmbed)}))}]}class Vega extends internal.f_{constructor(options){super(),(0,internal.S1)(this,options,Vega_svelte_instance,Vega_svelte_create_fragment,internal.N8,{props:0,data:5,onNewView:6,signalListeners:1,onError:2})}}const Vega_svelte=Vega,data1_namespaceObject=JSON.parse('{"table":[{"category":"A","amount":28},{"category":"B","amount":55},{"category":"C","amount":43},{"category":"D","amount":91},{"category":"E","amount":81},{"category":"F","amount":53},{"category":"G","amount":19},{"category":"H","amount":87}]}'),spec1={$schema:"https://vega.github.io/schema/vega/v5.json",width:400,height:200,padding:{left:5,right:5,top:5,bottom:5},data:[{name:"table",values:[{category:"A",amount:28},{category:"B",amount:55},{category:"C",amount:43},{category:"D",amount:91},{category:"E",amount:81},{category:"F",amount:53},{category:"G",amount:19},{category:"H",amount:87}]}],signals:[{name:"tooltip",value:{},on:[{events:"rect:mouseover",update:"datum"},{events:"rect:mouseout",update:"{}"}]}],scales:[{name:"xscale",type:"band",domain:{data:"table",field:"category"},range:"width"},{name:"yscale",domain:{data:"table",field:"amount"},nice:!0,range:"height"}],axes:[{orient:"bottom",scale:"xscale"},{orient:"left",scale:"yscale"}],marks:[{type:"rect",from:{data:"table"},encode:{enter:{x:{scale:"xscale",field:"category",offset:1},width:{scale:"xscale",band:1,offset:-1},y:{scale:"yscale",field:"amount"},y2:{scale:"yscale",value:0}},update:{fill:{value:"steelblue"}},hover:{fill:{value:"red"}}}},{type:"text",encode:{enter:{align:{value:"center"},baseline:{value:"bottom"},fill:{value:"#333"}},update:{x:{scale:"xscale",signal:"tooltip.category",band:.5},y:{scale:"yscale",signal:"tooltip.amount",offset:-2},text:{signal:"tooltip.amount"},fillOpacity:[{test:"datum === tooltip",value:0},{value:1}]}}}]},spec2={$schema:"https://vega.github.io/schema/vega/v5.json",width:400,height:200,padding:{left:5,right:5,top:5,bottom:5},data:[{name:"table",values:[{category:"A",amount:28},{category:"B",amount:55},{category:"C",amount:43},{category:"D",amount:91},{category:"E",amount:81},{category:"F",amount:53},{category:"G",amount:19},{category:"H",amount:87}]}],signals:[{name:"tooltip",value:{},on:[{events:"rect:mouseover",update:"datum"},{events:"rect:mouseout",update:"{}"}]}],scales:[{name:"xscale",type:"band",domain:{data:"table",field:"category"},range:"width"},{name:"yscale",domain:{data:"table",field:"amount"},nice:!0,range:"height"}],axes:[{orient:"bottom",scale:"xscale"},{orient:"left",scale:"yscale"}],marks:[{type:"rect",from:{data:"table"},encode:{enter:{x:{scale:"xscale",field:"category",offset:10},width:{scale:"xscale",band:.5,offset:-1},y:{scale:"yscale",field:"amount"},y2:{scale:"yscale",value:0}},update:{fill:{value:"green"}},hover:{fill:{value:"yellow"}}}},{type:"text",encode:{enter:{align:{value:"center"},baseline:{value:"bottom"},fill:{value:"#333"}},update:{x:{scale:"xscale",signal:"tooltip.category",band:.5},y:{scale:"yscale",signal:"tooltip.amount",offset:-2},text:{signal:"tooltip.amount"},fillOpacity:[{test:"datum === tooltip",value:0},{value:1}]}}}]};function SvelteVegaDemo_svelte_create_fragment(ctx){let main,div0,div0_style_value,t0,button0,t2,button1,t4,div2,h3,t7,vega,t8,div1,t9,code1,t10,current,mounted,dispose;return vega=new Vega_svelte({props:{data:ctx[1],props:ctx[2],signalListeners:ctx[3]}}),{c(){main=(0,internal.bG)("main"),div0=(0,internal.bG)("div"),div0.innerHTML='<iframe title="star" src="https://ghbtns.com/github-btn.html?user=vega&amp;repo=svelte-vega&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="100px" height="20px"></iframe>',t0=(0,internal.Dh)(),button0=(0,internal.bG)("button"),button0.textContent="Toggle Spec",t2=(0,internal.Dh)(),button1=(0,internal.bG)("button"),button1.textContent="Update Data",t4=(0,internal.Dh)(),div2=(0,internal.bG)("div"),h3=(0,internal.bG)("h3"),h3.innerHTML="<code>&lt;Vega&gt;</code> Svelte Component",t7=(0,internal.fL)("\n    Will recompile when spec changes and update when data changes.\n    "),(0,internal.YC)(vega.$$.fragment),t8=(0,internal.Dh)(),div1=(0,internal.bG)("div"),t9=(0,internal.fL)("Hover info: "),code1=(0,internal.bG)("code"),t10=(0,internal.fL)(ctx[0]),(0,internal.Lj)(div0,"style",div0_style_value="float: right"),(0,internal.Lj)(div2,"class","content svelte-xcbl4w")},m(target,anchor){(0,internal.$T)(target,main,anchor),(0,internal.R3)(main,div0),(0,internal.R3)(main,t0),(0,internal.R3)(main,button0),(0,internal.R3)(main,t2),(0,internal.R3)(main,button1),(0,internal.R3)(main,t4),(0,internal.R3)(main,div2),(0,internal.R3)(div2,h3),(0,internal.R3)(div2,t7),(0,internal.ye)(vega,div2,null),(0,internal.R3)(div2,t8),(0,internal.R3)(div2,div1),(0,internal.R3)(div1,t9),(0,internal.R3)(div1,code1),(0,internal.R3)(code1,t10),current=!0,mounted||(dispose=[(0,internal.oL)(button0,"click",ctx[4]),(0,internal.oL)(button1,"click",ctx[5])],mounted=!0)},p(ctx,[dirty]){const vega_changes={};2&dirty&&(vega_changes.data=ctx[1]),4&dirty&&(vega_changes.props=ctx[2]),vega.$set(vega_changes),(!current||1&dirty)&&(0,internal.rT)(t10,ctx[0])},i(local){current||((0,internal.Ui)(vega.$$.fragment,local),current=!0)},o(local){(0,internal.et)(vega.$$.fragment,local),current=!1},d(detaching){detaching&&(0,internal.og)(main),(0,internal.vp)(vega),mounted=!1,(0,internal.j7)(dispose)}}}function SvelteVegaDemo_svelte_instance($$self,$$props,$$invalidate){let props,info="",data=data1_namespaceObject,spec=spec1;const handlers={tooltip:(...args)=>$$invalidate(0,info=JSON.stringify(args))};return $$self.$$.update=()=>{64&$$self.$$.dirty&&$$invalidate(2,props={spec,signalListeners:handlers})},[info,data,props,handlers,function handleToggleSpec(){$$invalidate(6,spec=spec===spec1?spec2:spec1)},function handleUpdateData(){const table=[];for(let i=1;i<=20;i++)table.push({amount:Math.round(100*Math.random()),category:String.fromCharCode(65+i)});$$invalidate(1,data={table})},spec]}class SvelteVegaDemo extends internal.f_{constructor(options){super(),document.getElementById("svelte-xcbl4w-style")||function add_css(){var style=(0,internal.bG)("style");style.id="svelte-xcbl4w-style",style.textContent=".content.svelte-xcbl4w{display:flex;flex-direction:column}",(0,internal.R3)(document.head,style)}(),(0,internal.S1)(this,options,SvelteVegaDemo_svelte_instance,SvelteVegaDemo_svelte_create_fragment,internal.N8,{})}}const SvelteVegaDemo_svelte=SvelteVegaDemo,SvelteVegaDemo_stories={title:"svelte-vega/Vega",component:SvelteVegaDemo_svelte,argTypes:{}};var Demo=function(){return{Component:SvelteVegaDemo_svelte}}.bind({})},68870:(module,__unused_webpack_exports,__webpack_require__)=>{var map={"./SvelteVegaDemo.stories.js":50787};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=68870},53260:()=>{}},__webpack_require__=>{"use strict";var __webpack_exec__=moduleId=>__webpack_require__(__webpack_require__.s=moduleId);__webpack_require__.O(0,[936],(()=>(__webpack_exec__(98612),__webpack_exec__(35350),__webpack_exec__(46113),__webpack_exec__(61021),__webpack_exec__(88900),__webpack_exec__(25622),__webpack_exec__(16374),__webpack_exec__(57685))));__webpack_require__.O()}]);
//# sourceMappingURL=main.89ad374c.iframe.bundle.js.map